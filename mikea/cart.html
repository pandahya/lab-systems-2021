<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>MIKEA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="style.css" rel="stylesheet">
</head>

<body>
    <nav>
        <div id="menuToggle">
            <input type="checkbox" />
            <span></span>
            <span></span>
            <span></span>
            <ul id="menu">
                <a href="rooms.html"><li>home</li></a>
                <a href="cart.html"><li id="cart_num">cart (0)</li></a>
                <a href="login.html"><li>login</li></a>
              </ul>
        </div>
    </nav>
<main class="fullwidth">
    <h1 class="breadcrumb"><a href="rooms.html">MIKEA</a> > <strong>my cart</strong></h1>
<div class="split">
    <section id="cart_box"> 
        <div class="item">plant</div>
    </section>
    <section id="cart_reciept">
        <div id="cart_reciept_box">
            <div class="two">
                <article id="product_list">
                    <h1>Product</h1>
                </article>
                <article id="price_list">
                    <h1>Price</h1>
                </article>
            </div>
            <div class="two">
                <article id="subtotal">
                    <h2>subtotal</h2>
                    <h2>tax</h2>
                </article>
                <article>
                    <h2 id="subprice"></h2>
                    <h2 id="tax"></h2>
                </article>
            </div>
            <div class="two" style="border-bottom:none">
                <article id="total">
                    <h2>total</h2>
                </article>
                <article>
                    <h2 id="total_price"></h2>
                </article>
            </div>
        </div>
        <article>
            <h2 style="text-align:right"><a href="checkout.html">checkout &rarr;</a></h2>
        </article>
    </section>
    
</div>
</main>
</body>
<script>
    const cartNum = document.getElementById("cart_num");
    const productList = document.getElementById("product_list");
    const priceList = document.getElementById("price_list");
    const subprice = document.getElementById("subprice")
    const tax = document.getElementById("tax");
    const totalPrice = document.getElementById("total_price");
    let cartItems = [];
    let cartPrices = [];
    let subpriceNum, taxNum, totalNum;

    //need to -1 for vscode
    let plantNum = sessionStorage.length;
    cartNum.innerHTML = `cart (${sessionStorage.length})`;

    for(let i=0; i<plantNum; i++){
        cartItems.push("plant");
        cartPrices.push("200");
        subpriceNum = i*200;
        taxNum = subpriceNum*0.2;
        totalNum = subpriceNum + taxNum;
    }
    cartItems.forEach(function(){
        const p1 = document.createElement("P");
        const p2 = document.createElement("P");
        const listPlant = document.createTextNode("plant");
        const listPrice = document.createTextNode("$200");
        p1.appendChild(listPlant);
        productList.appendChild(p1);
        p2.appendChild(listPrice);
        priceList.appendChild(p2);
        subprice.innerHTML = "$"+subpriceNum;
        tax.innerHTML = "$"+taxNum;
        totalPrice.innerHTML = "$"+totalNum;
    });

    //https://www.kirupa.com/html5/drag.htm
    let dragItem = document.querySelector(".item");
    let cartBox = document.querySelector("#cart_box");
    let active = false;
    let currentX, currentY, initialX, initialY;
    let xOffset = 0;
    let yOffset = 0;

    cartBox.addEventListener("mousedown", dragStart, false);
    cartBox.addEventListener("mouseup", dragEnd, false);
    cartBox.addEventListener("mousemove", drag, false);

    function dragStart(e) {
        initialX = e.clientX - xOffset;
        initialY = e.clientY - yOffset;
        if (e.target === dragItem) {
            active = true;
        }
    }
    function dragEnd(e){
        intialX = currentX;
        initialY = currentY;
        active = false;
    }
    function drag(e){
        if(active){
            e.preventDefault();
            currentX = e.clientX - initialX;
            currentY = e.clientY - initialY;
            xOffset = currentX;
            yOffset = currentY;
            setTranslate(currentX, currentY, dragItem);
        }
    }
    function setTranslate(xPos, yPos, el){
        el.style.transform = `translate3d(${xPos}px, ${yPos}px, 0)`;
    }

</script>
</html>